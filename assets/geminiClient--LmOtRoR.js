const e="https://publisher.mrf103.com/ai",t="llama3.2:3b";class s{constructor(e=t){this.model=e}async invokeLLM({messages:t,temperature:s=.7,max_tokens:o=4e3}){try{const a=await fetch(`${e}/v1/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,messages:t,temperature:s,max_tokens:o,stream:!1})});if(!a.ok){const e=await a.text();throw new Error(`Ollama ${a.status}: ${e.slice(0,200)}`)}const r=await a.json();return{status:"success",output:r.choices?.[0]?.message?.content||"",usage:r.usage||{}}}catch(a){throw new Error(`فشل استدعاء المساعد الذكي: ${a.message}`)}}async generateContent(t,s={}){try{const o=await fetch(`${e}/v1/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,messages:[{role:"user",content:t}],temperature:s.temperature??.7,max_tokens:s.max_tokens??4e3,stream:!1})});if(!o.ok)throw new Error(`Ollama ${o.status}`);const a=await o.json();return a.choices?.[0]?.message?.content||""}catch(o){throw new Error(`فشل توليد المحتوى: ${o.message}`)}}async streamContent(t,s,o={}){try{const a=await fetch(`${e}/v1/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:this.model,messages:[{role:"user",content:t}],temperature:o.temperature??.7,max_tokens:o.max_tokens??4e3,stream:!0})});if(!a.ok)throw new Error(`Ollama ${a.status}`);const r=a.body.getReader(),n=new TextDecoder;let c="";for(;;){const{done:e,value:t}=await r.read();if(e)break;const o=n.decode(t).split("\n").filter(e=>e.startsWith("data: "));for(const a of o){const e=a.slice(6);if("[DONE]"!==e)try{const t=JSON.parse(e),o=t.choices?.[0]?.delta?.content||"";o&&(c+=o,s(o))}catch{}}}return c}catch(a){throw new Error(`فشل streaming: ${a.message}`)}}}const o=new s,a=new s(t);export{o as a,a as g};
