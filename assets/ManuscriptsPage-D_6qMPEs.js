import{j as e}from"./query-vendor-Dt0le05-.js";import{f as s,a as t}from"./react-vendor-Bs_e_mwx.js";import{B as a,c as r,b as l,L as o}from"./index-3Yd-DfCj.js";import{u as n,a as d}from"./useManuscripts-Badbure7.js";import{A as c,R as i,s as x,B as h,t as m,f as u,C as p,T as b,u as g,F as w,v as j,w as f,D as N,x as v}from"./ui-vendor-CeVg9BGE.js";import"./chart-vendor-ce8NDi9W.js";import"./index-DH6jIlqu.js";import"./geminiClient--LmOtRoR.js";import"./jszip.min-Daw9fIkx.js";function y({title:s="حدث خطأ",message:t="عذراً، حدث خطأ أثناء تحميل البيانات",onRetry:r,showRetry:l=!0}){return e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4 text-center",children:[e.jsx("div",{className:"mb-4 p-4 rounded-full bg-red-500/10 border border-red-500/20",children:e.jsx(c,{className:"h-12 w-12 text-red-500"})}),e.jsx("h3",{className:"text-xl font-semibold text-shadow-text mb-2",children:s}),e.jsx("p",{className:"text-shadow-text/60 max-w-md mb-6",children:t}),l&&r&&e.jsxs(a,{onClick:r,variant:"outline",className:"gap-2",children:[e.jsx(i,{className:"h-4 w-4"}),"إعادة المحاولة"]})]})}function C({icon:s,label:t,value:a,color:l="default",trend:o}){return e.jsx("div",{className:"bg-shadow-surface rounded-xl border border-shadow-border/50 p-5 transition-all duration-300 hover:border-purple-500/40 hover:shadow-cyber group",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:r("p-3 rounded-xl border",{default:"text-purple-400 bg-purple-500/15 border-purple-500/20",blue:"text-cyan-400 bg-cyan-500/15 border-cyan-500/20",green:"text-emerald-400 bg-emerald-500/15 border-emerald-500/20",yellow:"text-amber-400 bg-amber-500/15 border-amber-500/20",red:"text-red-400 bg-red-500/15 border-red-500/20",pink:"text-pink-400 bg-pink-500/15 border-pink-500/20"}[l]),children:s}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-shadow-muted",children:t}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("p",{className:"text-2xl font-bold text-shadow-text font-cyber",children:a}),o&&e.jsxs("span",{className:r("text-xs font-medium",o>0?"text-emerald-400":"text-red-400"),children:[o>0?"↑":"↓"," ",Math.abs(o),"%"]})]})]})]})})}function k({children:s,centered:t=!1,className:a=""}){const r=t?"min-h-screen bg-shadow-bg flex items-center justify-center":"min-h-screen bg-shadow-bg";return e.jsx("div",{className:`${r} ${a}`,children:s})}function L({children:s,className:t=""}){return e.jsx("div",{className:`max-w-7xl mx-auto p-6 ${t}`,children:s})}function S({title:s,subtitle:t,action:a,children:r}){return e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-bold text-shadow-text cyber-text",children:s}),t&&e.jsx("p",{className:"text-shadow-text/60 mt-2",children:t})]}),a||r]})}const _=()=>{const a=s(),{success:r,error:c}=l(),{data:i,isLoading:j,isError:f}=n(),N=d(),[v,_]=t.useState(""),[D,M]=t.useState("all"),[E,R]=t.useState("recent"),[z,A]=t.useState("grid"),W=t.useMemo(()=>{if(!i)return[];let e=i;return v&&(e=e.filter(e=>e.title.toLowerCase().includes(v.toLowerCase())||e.author?.toLowerCase().includes(v.toLowerCase())||e.genre?.toLowerCase().includes(v.toLowerCase()))),"all"!==D&&(e=e.filter(e=>e.status===D)),e=[...e].sort((e,s)=>{switch(E){case"recent":return new Date(s.updated_at)-new Date(e.updated_at);case"oldest":return new Date(e.updated_at)-new Date(s.updated_at);case"title":return e.title.localeCompare(s.title,"ar");case"wordCount":return(s.word_count||0)-(e.word_count||0);default:return 0}}),e},[i,v,D,E]),B=t.useMemo(()=>i?{total:i.length,draft:i.filter(e=>"draft"===e.status).length,processing:i.filter(e=>"processing"===e.status).length,completed:i.filter(e=>"completed"===e.status).length,totalWords:i.reduce((e,s)=>e+(s.word_count||0),0)}:{total:0,draft:0,processing:0,completed:0,totalWords:0},[i]),F=()=>{a("/upload")},V=e=>{a(`/manuscripts/${e.id}`)},q=e=>{a(`/elite-editor/${e.id}`)},K=e=>{a("/export",{state:{manuscript:e}})},T=async e=>{if(confirm(`هل تريد حذف "${e.title}"؟`))try{await N.mutateAsync(e.id),r("تم حذف المخطوط بنجاح")}catch(s){c("فشل حذف المخطوط: "+(s.message||"خطأ غير معروف"))}};return j?e.jsx("div",{className:"min-h-screen bg-shadow-bg flex items-center justify-center",children:e.jsx(o,{size:"lg",text:"جاري تحميل المخطوطات..."})}):f?e.jsx("div",{className:"min-h-screen bg-shadow-bg flex items-center justify-center p-6",children:e.jsx(y,{title:"حدث خطأ",message:"فشل تحميل المخطوطات. يرجى المحاولة مرة أخرى.",onRetry:()=>window.location.reload()})}):e.jsx(k,{children:e.jsxs(L,{children:[e.jsx(S,{title:"مخطوطاتي",subtitle:"إدارة ومتابعة جميع أعمالك الأدبية",action:e.jsxs("button",{onClick:F,className:"cyber-button bg-shadow-accent px-6 py-3 rounded-lg hover:shadow-glow transition-all flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5"}),"مخطوط جديد"]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(C,{icon:e.jsx(h,{className:"w-6 h-6"}),label:"إجمالي المخطوطات",value:B.total.toLocaleString(),color:"default"}),e.jsx(C,{icon:e.jsx(m,{className:"w-6 h-6"}),label:"مسودات",value:B.draft.toLocaleString(),color:"blue"}),e.jsx(C,{icon:e.jsx(u,{className:"w-6 h-6"}),label:"قيد المعالجة",value:B.processing.toLocaleString(),color:"yellow"}),e.jsx(C,{icon:e.jsx(p,{className:"w-6 h-6"}),label:"مكتملة",value:B.completed.toLocaleString(),color:"green"}),e.jsx(C,{icon:e.jsx(b,{className:"w-6 h-6"}),label:"إجمالي الكلمات",value:(B.totalWords/1e3).toFixed(1)+"K",color:"default"})]}),e.jsx("div",{className:"cyber-card bg-shadow-surface rounded-lg border border-shadow-primary/20 p-4",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(g,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-shadow-text/40"}),e.jsx("input",{type:"text",placeholder:"ابحث عن مخطوط...",value:v,onChange:e=>_(e.target.value),className:"w-full pr-10 pl-4 py-2 bg-shadow-bg border border-shadow-primary/30 rounded-lg text-shadow-text placeholder:text-shadow-text/40 focus:outline-none focus:border-shadow-accent transition-colors"})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("select",{value:D,onChange:e=>M(e.target.value),className:"px-4 py-2 bg-shadow-bg border border-shadow-primary/30 rounded-lg text-shadow-text focus:outline-none focus:border-shadow-accent transition-colors",children:[e.jsx("option",{value:"all",children:"جميع الحالات"}),e.jsx("option",{value:"draft",children:"مسودة"}),e.jsx("option",{value:"processing",children:"قيد المعالجة"}),e.jsx("option",{value:"completed",children:"مكتملة"})]}),e.jsxs("select",{value:E,onChange:e=>R(e.target.value),className:"px-4 py-2 bg-shadow-bg border border-shadow-primary/30 rounded-lg text-shadow-text focus:outline-none focus:border-shadow-accent transition-colors",children:[e.jsx("option",{value:"recent",children:"الأحدث"}),e.jsx("option",{value:"oldest",children:"الأقدم"}),e.jsx("option",{value:"title",children:"الاسم"}),e.jsx("option",{value:"wordCount",children:"عدد الكلمات"})]}),e.jsx("button",{onClick:()=>A("grid"===z?"list":"grid"),className:"px-4 py-2 bg-shadow-bg border border-shadow-primary/30 rounded-lg text-shadow-text hover:border-shadow-accent transition-colors",children:"grid"===z?"قائمة":"شبكة"})]})]})}),0===W.length?e.jsxs("div",{className:"text-center py-16",children:[e.jsx(w,{className:"w-24 h-24 mx-auto text-shadow-text/20 mb-4"}),e.jsx("h3",{className:"text-2xl font-bold text-shadow-text mb-2",children:v||"all"!==D?"لا توجد نتائج":"لا توجد مخطوطات"}),e.jsx("p",{className:"text-shadow-text/60 mb-6",children:v||"all"!==D?"جرب تغيير معايير البحث":"ابدأ بإنشاء مخطوطك الأول"}),!v&&"all"===D&&e.jsxs("button",{onClick:F,className:"cyber-button bg-shadow-accent px-6 py-3 rounded-lg hover:shadow-glow transition-all inline-flex items-center gap-2",children:[e.jsx(x,{className:"w-5 h-5"}),"مخطوط جديد"]})]}):e.jsx("div",{className:`\n            ${"grid"===z?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4":"space-y-3"}\n          `,children:W.map(s=>e.jsx($,{manuscript:s,viewMode:z,onView:V,onEdit:q,onExport:K,onDelete:T},s.id))}),e.jsx("div",{className:"fixed inset-0 pointer-events-none opacity-10 cyber-grid -z-10"})]})})},$=({manuscript:s,viewMode:a,onView:r,onEdit:l,onExport:o,onDelete:n})=>{const[d,c]=t.useState(!1),i=e=>{switch(e){case"draft":return"text-blue-500 bg-blue-500/10";case"processing":return"text-yellow-500 bg-yellow-500/10";case"completed":return"text-green-500 bg-green-500/10";default:return"text-shadow-text/60 bg-shadow-bg"}},x=e=>{switch(e){case"draft":return"مسودة";case"processing":return"قيد المعالجة";case"completed":return"مكتملة";default:return e}},h=e=>new Date(e).toLocaleDateString("ar-SA",{year:"numeric",month:"short",day:"numeric"});return"list"===a?e.jsx("div",{className:"cyber-card bg-shadow-surface rounded-lg border border-shadow-primary/20 p-4 hover:border-shadow-accent transition-all",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-bold text-shadow-text truncate",children:s.title}),e.jsx("span",{className:`px-2 py-1 rounded text-xs ${i(s.status)}`,children:x(s.status)})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-shadow-text/60",children:[e.jsx("span",{children:s.author||"غير محدد"}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[(s.word_count||0).toLocaleString()," كلمة"]}),e.jsx("span",{children:"•"}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-4 h-4"}),h(s.updated_at)]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(D,{icon:e.jsx(f,{className:"w-4 h-4"}),onClick:()=>r(s),tooltip:"عرض"}),e.jsx(D,{icon:e.jsx(m,{className:"w-4 h-4"}),onClick:()=>l(s),tooltip:"تحرير"}),e.jsx(D,{icon:e.jsx(N,{className:"w-4 h-4"}),onClick:()=>o(s),tooltip:"تصدير"}),e.jsx(D,{icon:e.jsx(v,{className:"w-4 h-4"}),onClick:()=>n(s),tooltip:"حذف",danger:!0})]})]})}):e.jsx("div",{className:"cyber-card bg-shadow-surface rounded-lg border border-shadow-primary/20 p-4 hover:border-shadow-accent transition-all",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-shadow-text line-clamp-2",children:s.title}),e.jsx("span",{className:`px-2 py-1 rounded text-xs flex-shrink-0 ${i(s.status)}`,children:x(s.status)})]}),e.jsxs("div",{className:"space-y-2 text-sm text-shadow-text/60",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsxs("span",{children:[(s.word_count||0).toLocaleString()," كلمة"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:h(s.updated_at)})]})]}),e.jsxs("div",{className:"pt-3 border-t border-shadow-primary/20 flex gap-2",children:[e.jsx("button",{onClick:()=>r(s),className:"flex-1 cyber-button bg-shadow-accent/10 text-shadow-accent px-3 py-2 rounded text-sm hover:bg-shadow-accent/20 transition-all",children:"عرض"}),e.jsx("button",{onClick:()=>l(s),className:"flex-1 cyber-button bg-shadow-primary/10 text-shadow-text px-3 py-2 rounded text-sm hover:bg-shadow-primary/20 transition-all",children:"تحرير"})]})]})})},D=({icon:s,onClick:t,tooltip:a,danger:r=!1})=>e.jsx("button",{onClick:t,title:a,className:`\n      p-2 rounded transition-all\n      ${r?"hover:bg-red-500/10 text-red-500":"hover:bg-shadow-accent/10 text-shadow-text hover:text-shadow-accent"}\n    `,children:s});export{_ as default};
