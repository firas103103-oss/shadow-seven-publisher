import{j as e}from"./query-vendor-Dt0le05-.js";import{a as t}from"./react-vendor-Bs_e_mwx.js";import{C as s}from"./card-B349gX0B.js";import{e as a}from"./index-3Yd-DfCj.js";import{R as r,A as l,C as n,X as i,Y as d,T as c,L as o,a as x,P as m,b as h,d as j,B as g,e as u,f as p,g as y,h as b,i as f,j as v,k as N,l as w}from"./chart-vendor-ce8NDi9W.js";import"./ui-vendor-CeVg9BGE.js";const k=()=>{const[k,D]=t.useState({overview:{totalManuscripts:0,totalWords:0,totalReads:0,avgRating:0,growthRate:0},manuscriptStats:[],genreDistribution:[],readingTrends:[],userEngagement:[],performanceMetrics:[]}),[K,S]=t.useState("7d"),[M,R]=t.useState(!0);t.useEffect(()=>{_()},[K]);const _=async()=>{R(!0);try{const{data:e,error:t}=await a.from("manuscripts").select("id,title,word_count,genre,status,created_at");if(t)throw t;const s=e||[],r=s.length,l=s.reduce((e,t)=>e+(t.word_count||0),0),n=["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#6366f1","#14b8a6"],i=s.reduce((e,t)=>{const s=t.genre||"ØºÙŠØ± Ù…Ø­Ø¯Ø¯";return e[s]=(e[s]||0)+1,e},{}),d=Object.entries(i).map(([e,t],s)=>({name:e,value:t,color:n[s%n.length]})),c=[...s].sort((e,t)=>(t.word_count||0)-(e.word_count||0)).slice(0,10).map(e=>({name:e.title||"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†",words:e.word_count||0,reads:0,rating:0,status:e.status||"draft"})),o=s.reduce((e,t)=>{if(!t.created_at)return e;const s=new Date(t.created_at);if(isNaN(s))return e;const a=s.toLocaleDateString("ar-EG");return e[a]||(e[a]={date:a,reads:0,likes:0,shares:0}),e[a].reads+=1,e},{}),x=Object.values(o).sort((e,t)=>new Date(e.date)-new Date(t.date)),m=s.reduce((e,t)=>{if(!t.created_at)return e;const s=new Date(t.created_at);if(isNaN(s))return e;const a=`${s.getFullYear()}-${s.getMonth()+1}`;return e[a]||(e[a]={month:a,manuscripts:0,reads:0,engagement:0}),e[a].manuscripts+=1,e},{}),h=Object.values(m).sort((e,t)=>e.month.localeCompare(t.month));D({overview:{totalManuscripts:r,totalWords:l,totalReads:0,avgRating:0,growthRate:0},manuscriptStats:c,genreDistribution:d,readingTrends:x,userEngagement:[],performanceMetrics:h})}catch(e){D(e=>({...e,overview:{...e.overview,totalManuscripts:0,totalWords:0},manuscriptStats:[],genreDistribution:[],readingTrends:[],performanceMetrics:[],userEngagement:[]}))}finally{R(!1)}},I=({title:t,value:a,subtitle:r,icon:l,trend:n})=>e.jsxs(s,{className:"p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-sm text-gray-600",children:t}),e.jsx("p",{className:"text-3xl font-bold text-gray-900",children:a}),r&&e.jsx("p",{className:"text-sm text-gray-500",children:r})]}),e.jsx("div",{className:"text-4xl",children:l})]}),n&&e.jsxs("div",{className:"mt-4 text-sm font-medium "+(n>0?"text-green-600":"text-red-600"),children:[n>0?"â†‘":"â†“"," ",Math.abs(n),"% Ù…Ù† Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø§Ø¶ÙŠ"]})]});return M?e.jsx("div",{className:"flex items-center justify-center h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 p-8",dir:"rtl",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-2",children:"ğŸ“Š Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª"}),e.jsx("p",{className:"text-gray-600",children:"ØªØ­Ù„ÙŠÙ„ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ù…Ø®Ø·ÙˆØ·Ø§ØªÙƒ ÙˆØªÙØ§Ø¹Ù„ Ø§Ù„Ù‚Ø±Ø§Ø¡"})]}),e.jsx("div",{className:"mb-6 flex gap-2",children:[{label:"7 Ø£ÙŠØ§Ù…",value:"7d"},{label:"30 ÙŠÙˆÙ…",value:"30d"},{label:"90 ÙŠÙˆÙ…",value:"90d"},{label:"Ø³Ù†Ø©",value:"1y"}].map(t=>e.jsx("button",{onClick:()=>S(t.value),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(K===t.value?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"),children:t.label},t.value))}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(I,{title:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª",value:k.overview.totalManuscripts,icon:"ğŸ“š",trend:0}),e.jsx(I,{title:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ„Ù…Ø§Øª",value:k.overview.totalWords.toLocaleString(),icon:"ğŸ“",trend:0}),e.jsx(I,{title:"Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª",value:k.overview.totalReads.toLocaleString(),icon:"ğŸ‘ï¸",trend:0}),e.jsx(I,{title:"Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…",value:k.overview.avgRating.toFixed(1),subtitle:"Ù…Ù† 5.0",icon:"â­",trend:0})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[e.jsxs(s,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ“ˆ Ø§ØªØ¬Ø§Ù‡Ø§Øª Ø§Ù„Ù‚Ø±Ø§Ø¡Ø©"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(l,{data:k.readingTrends,children:[e.jsx(n,{strokeDasharray:"3 3"}),e.jsx(i,{dataKey:"date"}),e.jsx(d,{}),e.jsx(c,{}),e.jsx(o,{}),e.jsx(x,{type:"monotone",dataKey:"reads",stackId:"1",stroke:"#3b82f6",fill:"#3b82f6",name:"Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª"}),e.jsx(x,{type:"monotone",dataKey:"likes",stackId:"1",stroke:"#10b981",fill:"#10b981",name:"Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨Ø§Øª"}),e.jsx(x,{type:"monotone",dataKey:"shares",stackId:"1",stroke:"#f59e0b",fill:"#f59e0b",name:"Ø§Ù„Ù…Ø´Ø§Ø±ÙƒØ§Øª"})]})})]}),e.jsxs(s,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ¯ ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹ Ø§Ù„Ø£Ø¯Ø¨ÙŠØ©"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(m,{children:[e.jsx(h,{data:k.genreDistribution,cx:"50%",cy:"50%",labelLine:!1,label:({name:e,percent:t})=>`${e} (${(100*t).toFixed(0)}%)`,outerRadius:100,fill:"#8884d8",dataKey:"value",children:k.genreDistribution.map((t,s)=>e.jsx(j,{fill:t.color},`cell-${s}`))}),e.jsx(c,{})]})})]}),e.jsxs(s,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ“Š Ø£Ø¯Ø§Ø¡ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(g,{data:k.manuscriptStats,children:[e.jsx(n,{strokeDasharray:"3 3"}),e.jsx(i,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),e.jsx(d,{}),e.jsx(c,{}),e.jsx(o,{}),e.jsx(u,{dataKey:"reads",fill:"#3b82f6",name:"Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª"}),e.jsx(u,{dataKey:"rating",fill:"#10b981",name:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (Ã—1000)"})]})})]}),e.jsxs(s,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ’« ØªÙØ§Ø¹Ù„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(p,{data:k.userEngagement,children:[e.jsx(y,{}),e.jsx(b,{dataKey:"metric"}),e.jsx(f,{angle:90,domain:[0,100]}),e.jsx(v,{name:"Ø§Ù„ØªÙØ§Ø¹Ù„",dataKey:"value",stroke:"#8b5cf6",fill:"#8b5cf6",fillOpacity:.6}),e.jsx(c,{})]})})]})]}),e.jsxs(s,{className:"p-6 mb-8",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ“… Ø§Ù„Ø£Ø¯Ø§Ø¡ Ø¹Ø¨Ø± Ø§Ù„Ø²Ù…Ù†"}),e.jsx(r,{width:"100%",height:300,children:e.jsxs(N,{data:k.performanceMetrics,children:[e.jsx(n,{strokeDasharray:"3 3"}),e.jsx(i,{dataKey:"month"}),e.jsx(d,{yAxisId:"left"}),e.jsx(d,{yAxisId:"right",orientation:"left"}),e.jsx(c,{}),e.jsx(o,{}),e.jsx(w,{yAxisId:"left",type:"monotone",dataKey:"manuscripts",stroke:"#3b82f6",name:"Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª",strokeWidth:2}),e.jsx(w,{yAxisId:"left",type:"monotone",dataKey:"reads",stroke:"#10b981",name:"Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª (Ã·100)",strokeWidth:2}),e.jsx(w,{yAxisId:"right",type:"monotone",dataKey:"engagement",stroke:"#f59e0b",name:"Ø§Ù„ØªÙØ§Ø¹Ù„ %",strokeWidth:2})]})})]}),e.jsxs(s,{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-4",children:"ğŸ† Ø£ÙØ¶Ù„ Ø§Ù„Ù…Ø®Ø·ÙˆØ·Ø§Øª Ø£Ø¯Ø§Ø¡Ù‹"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"#"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Ø§Ù„ÙƒÙ„Ù…Ø§Øª"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Ø§Ù„Ù‚Ø±Ø§Ø¡Ø§Øª"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Ø§Ù„ØªÙ‚ÙŠÙŠÙ…"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-700",children:"Ø§Ù„Ø­Ø§Ù„Ø©"})]})}),e.jsx("tbody",{className:"divide-y",children:k.manuscriptStats.map((t,s)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm",children:s+1}),e.jsx("td",{className:"px-4 py-3 text-sm font-medium",children:t.name}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.words.toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:t.reads.toLocaleString()}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-yellow-500",children:"â­"}),e.jsx("span",{children:t.rating})]})}),e.jsx("td",{className:"px-4 py-3 text-sm",children:e.jsx("span",{className:"px-2 py-1 rounded-full text-xs "+("Ù…Ù†Ø´ÙˆØ±Ø©"===t.status?"bg-green-100 text-green-800":"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"===t.status?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:t.status})})]},s))})]})})]}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsx("button",{className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg font-medium hover:shadow-lg transition-shadow",children:"ğŸ“¥ ØªØµØ¯ÙŠØ± Ø§Ù„ØªØ­Ù„ÙŠÙ„Ø§Øª (PDF)"})})]})};export{k as default};
